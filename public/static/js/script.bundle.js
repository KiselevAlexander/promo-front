!function e(t,r,n){function o(u,i){if(!r[u]){if(!t[u]){var l="function"==typeof require&&require;if(!i&&l)return l(u,!0);if(a)return a(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var s=r[u]={exports:{}};t[u][0].call(s.exports,function(e){var r=t[u][1][e];return o(r?r:e)},s,s.exports,e,t,r,n)}return r[u].exports}for(var a="function"==typeof require&&require,u=0;u<n.length;u++)o(n[u]);return o}({1:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),c=n(l),s=e("react-router"),f=function(){},d=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),i(t,[{key:"render",value:function(){return c["default"].createElement(s.Router,{history:s.browserHistory,onUpdate:f},this.props.routes())}}]),t}(c["default"].Component);d.propTypes={routes:c["default"].PropTypes.func},d.defaultProps={routes:function(){}},r["default"]=d},{react:void 0,"react-router":void 0}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.SET_CALLS_BUSY="SET_CALLS_BUSY"},{}],3:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.App=void 0;{var o=e("react"),a=n(o),u=e("react-redux"),i=e("./store"),l=n(i),c=e("./Root"),s=n(c),f=e("./routes"),d=n(f),p=function(){};r.App=function(){return a["default"].createElement(u.Provider,{store:l["default"]},a["default"].createElement(s["default"],{routes:d["default"],onEnter:p(l["default"])}))}}},{"./Root":1,"./routes":14,"./store":15,react:void 0,"react-redux":void 0}],4:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),c=n(l),s=e("classnames"),f=n(s),d=e("react-dropzone"),p=n(d),m=e("promise-file-reader"),v=(e("react-router"),function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Object.defineProperty(r,"onImagePick",{enumerable:!0,writable:!0,value:function(e){console.log(e),m.readAsDataURL(e[0]).then(function(e){r.setState({imageSrc:e,showCase:!1})})}}),Object.defineProperty(r,"doCreateVideo",{enumerable:!0,writable:!0,value:function(){r.setState({showCase:!0})}}),r.state={imageSrc:"",status:"",result:{}},r}return u(t,e),i(t,[{key:"render",value:function(){var e=this,t=this.state,r=t.imageSrc,n=t.status,o=t.showCase,a=t.isVideoLayerVisible,u=t.currentTime;return c["default"].createElement("main",null,c["default"].createElement("table",{style:{width:"100%"}},c["default"].createElement("tr",null,c["default"].createElement("td",{style:{verticalAlign:"top"}},c["default"].createElement(p["default"],{onDrop:this.onImagePick,disabled:"Pending"===n},"Pick file please"),r&&c["default"].createElement("button",{onClick:this.doCreateVideo,disabled:"Pending"===n},"Create video")),c["default"].createElement("td",{style:{verticalAlign:"top"}},r&&!o&&c["default"].createElement("img",{src:r,alt:"",style:{maxWidth:"100%"}}),o&&c["default"].createElement("div",{className:"case"},c["default"].createElement("video",{ref:function(t){e.videoPlayer=t}},c["default"].createElement("source",{src:"/static/video_patterns/3.mp4",type:"video/mp4"})),c["default"].createElement("div",{className:f["default"]("layer",{"is-visible":a}),style:{backgroundImage:"url('"+r+"')"}}),c["default"].createElement("button",{onClick:function(){e.videoPlayer.play();var t={start:3,end:10},r=setInterval(function(){console.dir(e.videoPlayer),e.setState({currentTime:e.videoPlayer.currentTime}),e.videoPlayer.currentTime>t.start&&e.videoPlayer.currentTime<t.end&&!a?(e.setState({isVideoLayerVisible:!0}),console.log("show")):(e.setState({isVideoLayerVisible:!1}),console.log("hide")),e.videoPlayer.currentTime>=e.videoPlayer.duration&&clearInterval(r)},500)}},"play"),c["default"].createElement("div",{className:"seek"},u))))))}}]),t}(c["default"].Component));r["default"]=v},{classnames:void 0,"promise-file-reader":void 0,react:void 0,"react-dropzone":void 0,"react-router":void 0}],5:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),c=n(l),s=e("react-router"),f=e("react-dropzone"),d=n(f),p=e("promise-file-reader"),m=e("../../managers/request"),v=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Object.defineProperty(r,"onImagePick",{enumerable:!0,writable:!0,value:function(e){console.log(e),p.readAsDataURL(e[0]).then(function(e){r.setState({imageSrc:e})})}}),Object.defineProperty(r,"doCreateVideo",{enumerable:!0,writable:!0,value:function(){r.setState({status:"Pending"});var e={image:r.state.imageSrc};m.request.post("http://localhost:9000/api",e).then(function(e){return e.json()}).then(function(e){console.log(e),r.setState({status:"Complete",result:e})})["catch"](function(){r.setState({status:"Error"})})}}),r.state={imageSrc:"",status:"",result:{}},r}return u(t,e),i(t,[{key:"render",value:function(){var e=this.state,t=e.imageSrc,r=e.status,n=e.result;return c["default"].createElement("main",null,c["default"].createElement("table",{style:{width:"100%"}},c["default"].createElement("tr",null,c["default"].createElement("td",{style:{verticalAlign:"top"}},c["default"].createElement(d["default"],{onDrop:this.onImagePick,disabled:"Pending"===r},"Pick file please"),t&&c["default"].createElement("button",{onClick:this.doCreateVideo,disabled:"Pending"===r},"Create video"),r&&c["default"].createElement("div",null,"Status: ",r),"Complete"===r&&c["default"].createElement("div",null,"Link to player:",c["default"].createElement(s.Link,{to:n.link},n.link))),c["default"].createElement("td",{style:{verticalAlign:"top"}},t&&c["default"].createElement("img",{src:t,alt:"",style:{maxWidth:"100%"}})))))}}]),t}(c["default"].Component);r["default"]=v},{"../../managers/request":11,"promise-file-reader":void 0,react:void 0,"react-dropzone":void 0,"react-router":void 0}],6:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),c=n(l),s=e("react-html5video"),f=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={},r}return u(t,e),i(t,[{key:"render",value:function(){var e=this.props.params.videoID;return c["default"].createElement("div",{id:"player"},c["default"].createElement("h2",null,"Player"),c["default"].createElement(s.DefaultPlayer,{autoPlay:!1,controls:["PlayPause","Seek","Time","Volume","Fullscreen"],poster:"/public/images/"+e+".jpg",onCanPlayThrough:function(){}},c["default"].createElement("source",{src:"/public/video/"+e+".mp4",type:"video/mp4"})))}}]),t}(c["default"].Component);r["default"]=f},{react:void 0,"react-html5video":void 0}],7:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),c=n(l),s=e("react-router"),f=e("react-redux"),d=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),i(t,[{key:"render",value:function(){return c["default"].createElement("main",null,c["default"].createElement("h1",null,"Promo App"),c["default"].createElement(s.Link,{to:"/editor"},"Editor"),c["default"].createElement("div",{className:"main-block"},this.props.children))}}]),t}(c["default"].Component),p=function(){return{}},m=function(){return{}};r["default"]=f.connect(p,m)(d)},{react:void 0,"react-redux":void 0,"react-router":void 0}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.ERROR_TYPES={CONNECTION_REFUSED:"connection_refused",BAD_REQUEST:"bad_request",UNAUTHORIZED:"unauthorized",FORBIDDEN:"forbidden",NOT_FOUND:"not_found",CONFLICT:"conflict",INTERNAL_SERVER_ERROR:"internal_server_error",UNKNOWN:"unknown"}},{}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});{var n=(r.DATE_MASK="DD.MM.YYYY",r.CLIENT_ID="website_client",r.CLIENT_SECRET="nA2REtuw$a-uZ?R3sw&s5A!UW2veDU3U",r.API_BASE_URL="http://localhost:9000/api/v1");r.API_URLS={CALLS:{IMPORT:n+"/calls/import",EXPORT:n+"/calls/export",EXCEPTIONS:n+"/calls/exceptions"},USERS:{GETLIST:"/users"},GARBAGE:{EXPORT:"/garbage/export"}},r.PRIVATE_CACHE_FLAG="private"}},{}],10:[function(e,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var n=e("react"),o=r(n),a=e("react-dom"),u=r(a);e("moment/locale/ru"),e("core-js/shim");var i=e("./app"),l=function(e){return u["default"].render(o["default"].createElement(e,null),document.getElementById("root"))};l(i.App),t.hot&&t.hot.accept("./app",function(){var t=e("./app").App;l(t)})},{"./app":3,"core-js/shim":void 0,"moment/locale/ru":void 0,react:void 0,"react-dom":void 0}],11:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.request=void 0;{var o=e("lodash"),a=n(o),u=e("url"),i=n(u),l=e("crypto-js"),c=n(l),s=e("../utils/fetch"),f=n(s),d=e("../utils/cache-manager"),p=e("../consts"),m=6e4;r.request={get:function(e,t,r,n){if(n instanceof Object){var o=n.name||e+":"+JSON.stringify(t),a=n.flag,u=n.lifeTime||m,i=d.cacheManager.getItem(o);return i?Promise.resolve(i):this._request("GET",e,t,null,r).then(function(e){return d.cacheManager.setItem(o,e,u,a),e})}return this._request("GET",e,t,null,r)},post:function(e,t,r){return this._request("POST",e,null,t,r)},put:function(e,t,r){return this._request("PUT",e,null,t,r)},"delete":function(e,t){return this._request("DELETE",e,null,null,t)},_request:function(e,t,r,n){var o=new Headers,a=null,u=t;return"GET"===e&&r&&(r={json:JSON.stringify(r)},u=t+i["default"].format({query:r})),"POST"!==e&&"PUT"!==e||!n||(o.append("Content-type","application/json"),a=JSON.stringify(n)),f["default"](u,{headers:o,method:e,body:a})["catch"](s.parseError)},_signData:function(e,t,r){var n=r&&JSON.stringify(r),o=a["default"].chain(t).toPairs().sortBy(0).map(function(e){return a["default"].join(e,":")}).join("|").value(),u=a["default"].chain([e,o,n]).compact().join("+").value(),i=c["default"].HmacSHA256(u,p.CLIENT_SECRET);return c["default"].enc.Base64.stringify(i)}}}},{"../consts":9,"../utils/cache-manager":16,"../utils/fetch":17,"crypto-js":void 0,lodash:void 0,url:void 0}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("../actions/calls"),a={exceptions:["79182881215","79182881211","79182881212","79182881213","79182881214"],isBusy:!1},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments[1],r=t.type,u=t.name,i=t.number,l=t.exceptions,c=t.error;switch(r){case o.SET_CALLS_BUSY:return n({},e,{isBusy:!0});case o.SET_CALLS_EX_NUMBERS:return console.log(l),n({},a,{exceptions:l});case o.ADD_CALLS_EX_NUMBER:var s=e.exceptions;return c||s.unshift({name:u,number:i}),n({},a,{exceptions:s});case o.REMOVE_CALLS_EX_NUMBER:return n({},a,{exceptions:e.exceptions.filter(function(e){return e.number!==i})});default:return a}};r["default"]=u},{"../actions/calls":2}],13:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("redux"),a=e("./calls"),u=n(a);r["default"]=o.combineReducers({calls:u["default"]})},{"./calls":12,redux:void 0}],14:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("react"),a=n(o),u=e("react-router"),i=e("./components/root"),l=n(i),c=e("./components/main"),s=n(c),f=e("./components/player"),d=n(f),p=e("./components/editor"),m=n(p),v=e("./store"),y=n(v),h=function(){},b=function(){return a["default"].createElement(u.Route,{path:"",onEnter:h(y["default"]),component:l["default"]},a["default"].createElement(u.Route,{path:"/"},a["default"].createElement(u.IndexRoute,{component:s["default"]}),a["default"].createElement(u.Route,{path:"/player/:videoID",component:d["default"]}),a["default"].createElement(u.Route,{path:"/editor",component:m["default"]})))};r["default"]=b},{"./components/editor":4,"./components/main":5,"./components/player":6,"./components/root":7,"./store":15,react:void 0,"react-router":void 0}],15:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("redux-thunk"),a=n(o),u=e("redux"),i=e("./reducers"),l=n(i),c=u.createStore(l["default"],u.applyMiddleware(a["default"]));r["default"]=c},{"./reducers":13,redux:void 0,"redux-thunk":void 0}],16:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.cacheManager=void 0;{var n=e("./formatter"),o="crm_";r.cacheManager={setItem:function(e,t,r,n){var a=r?new Date(Date.now()+r):null;localStorage.setItem(o+e,JSON.stringify({expireDate:a,flag:n,data:t}))},getItem:function(e){var t=n.parseJson(localStorage.getItem(o+e));if(!(t instanceof Object))return null;if(!t.expireDate)return t.data;var r=new Date(t.expireDate),a=new Date;return r>a?t.data:null},getByFlag:function(e){return Object.keys(localStorage).filter(function(e){return e.startsWith(o)}).map(function(e){return n.parseJson(localStorage.getItem(e))}).filter(function(t){return t instanceof Object&&t.flag===e}).map(function(e){return e.data})},removeItem:function(e){localStorage.removeItem(o+e)},removeByFlag:function(e){return Object.keys(localStorage).filter(function(t){if(!t.startsWith(o))return!1;var r=n.parseJson(localStorage.getItem(t));return r instanceof Object&&r.flag===e}).forEach(function(e){return localStorage.removeItem(e)})},removeAll:function(){Object.keys(localStorage).forEach(function(e){e.startsWith(o)&&localStorage.removeItem(e)})},getExpireDate:function(e){var t=n.parseJson(localStorage.getItem(o+e));return t&&t.data&&t.expireDate?new Date(t.expireDate):null},subscribe:function(e,t){window.addEventListener("storage",function(r){r.key===o+e&&t(r)})}}}},{"./formatter":18}],17:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseError=r.parseBody=void 0,e("whatwg-fetch");var n=e("../constants/errorTypes"),o=function(){return fetch.apply(void 0,arguments).then(function(e){if(e.status>=400)throw e;return e})};r["default"]=o;{var a=r.parseBody=function(e){var t=e.headers.get("Content-Type");return t.startsWith("application/json")?e.json():t.startsWith("text/")?e.text():e.blob()};r.parseError=function(e){if(e instanceof Response)return a(e).then(function(t){var r=n.ERROR_TYPES.UNKNOWN;throw 400===e.status?r=n.ERROR_TYPES.BAD_REQUEST:401===e.status?r=n.ERROR_TYPES.UNAUTHORIZED:403===e.status?r=n.ERROR_TYPES.FORBIDDEN:404===e.status?r=n.ERROR_TYPES.NOT_FOUND:409===e.status?r=n.ERROR_TYPES.CONFLICT:e.status>=500&&(r=n.ERROR_TYPES.INTERNAL_SERVER_ERROR),{code:r,data:t}});throw{code:n.ERROR_TYPES.UNKNOWN,data:e}}}},{"../constants/errorTypes":8,"whatwg-fetch":void 0}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.usernameToString=r.addressToString=r.upperCaseName=r.ucfirst=r.parseJson=r.formatPrice=r.formatCardNumber=r.formatNumber=void 0;{var n=e("../consts"),o=r.formatNumber=function(e){return null===e||void 0===e?null:e.toString().replace(/(\d{1})(\d{3})(\d{3})(\d{2})(\d{2})/,"+7 ($2) $3-$4-$5")},a=(r.formatCardNumber=function(e){return e?e.toString().replace(/(\d)(?=(\d{4})+(?!\d))/g,"$1 "):null},r.formatPrice=function(e,t){if(!e)return null;var r=o(e);return r+" "+n.CURRENCIES[t].label},r.parseJson=function(e){try{return JSON.parse(e)}catch(t){return null}},r.ucfirst=function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()});r.upperCaseName=function(e){return e.replace(/[\wа-яА-Я]\S*/g,a)},r.addressToString=function(e){if(!e)return null;if("string"==typeof e)return e;var t=[];return e.city&&t.push(e.city),e.address&&t.push(e.address),t.join(", ")},r.usernameToString=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!1;if(!e)return null;var n=t?e.international:e.original;if("undefined"==typeof n)return"";var o=[];return n.name&&o.push(n.name),!r&&n.secondName&&o.push(n.secondName),n.surname&&o.push(n.surname),o.length?o.join(" ").trim():""}}},{"../consts":9}]},{},[10]);